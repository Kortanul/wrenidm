{
  "embedded": true,
  "security": {
    "trustManager": "jvm",

    "fileBasedTrustManagerType": "JKS",
    "fileBasedTrustManagerFile": "/path/to/truststore",
    "fileBasedTrustManagerPasswordFile": "/path/to/pinfile",

    "keyManager": "jvm",

    "fileBasedKeyManagerType": "JKS",
    "fileBasedKeyManagerFile": "/path/to/keystore",
    "fileBasedKeyManagerPasswordFile": "/path/to/pinfile",

    "pkcs11KeyManagerPasswordFile": "/path/to/pinfile"
  },
  "ldapConnectionFactories": {
    "bind": {
      "connectionSecurity": "none",
      "sslCertAlias": "client-cert",
      "connectionPoolSize": 24,
      "heartBeatIntervalSeconds": 30,
      "heartBeatTimeoutMilliSeconds": 500,
      "primaryLdapServers": [{ "hostname": "localhost", "port": 1389 }],
      "secondaryLdapServers": []
    },
    "root": {
      "inheritFrom": "bind",
      "authentication": {
        "simple": { "bindDn": "cn=directory manager", "bindPassword": "password" }
      }
    }
  },
  "queries": {
    "generic": {
      "query-all-ids": {
        "_queryFilter": "true",
        "_fields": "_id,_rev"
      },
      "credential-query": {
        "_queryFilter": "/userName eq \"${username}\""
      },
      "credential-internaluser-query": {
        "_queryFilter": "/_id eq \"${username}\""
      },
      "get-by-field-value": {
        "_queryFilter": "/${field} eq \"${value}\""
      },
      "for-userName":	{
        "_queryFilter": "/userName eq \"${uid}\""
      },
      "query-all": {
        "_queryFilter": "true"
      },
      "links-for-firstId": {
        "_queryFilter": "/linkType eq \"${linkType}\" AND /firstId = \"${firstId}\""
      },
      "links-for-linkType": {
        "_queryFilter": "/linkType eq \"${linkType}\""
      },
      "scan-tasks": {
        "_queryFilter": "${property} lt ${condition.before} and !(${taskState.completed} pr)"
      },
      "get-recons": {
        "_queryFilter": "/entryType eq \"summary\"",
        "_fields": "reconId,mapping,activitydate",
        "_sortKeys": "-activitydate"
      },
      "get-notifications-for-user": {
        "_queryFilter": "/receiverId eq \"${userId}\"",
        "_sortKeys": "-createDate"
      },
      "query-cluster-failed-instances": {
        "_queryFilter": "/timestamp le ${timestamp} and (/state eq \"1\" or /state eq \"2\")"
      },
      "query-cluster-instances": {
        "_queryFilter": "true"
      },
      "query-cluster-events": {
        "_queryFilter": "/instanceId eq \"${instanceId}\""
      },
      "find-relationships-for-resource": {
        "_queryFilter": "(/firstId eq \"${fullResourceId}\" and /firstPropertyName eq \"${resourceFieldName}\") or (/secondId eq \"${fullResourceId}\" and /secondPropertyName eq \"${resourceFieldName}\")"
      },
      "find-relationship-edges": {
        "_queryFilter": "((/firstId eq \"${vertex1Id}\" and /firstPropertyName eq \"${vertex1FieldName}\") and (/secondId eq \"${vertex2Id}\" and /secondPropertyName eq \"${vertex2FieldName}\")) or ((/firstId eq \"${vertex2Id}\" and /firstPropertyName eq \"${vertex2FieldName}\") and (/secondId eq \"${vertex1Id}\" and /secondPropertyName eq \"${vertex1FieldName}\"))"
      }
    },
    "explicit": {
      "query-all-ids": {
        "_queryFilter": "true",
        "_fields": "_id,_rev"
      },
      "credential-query": {
        "_queryFilter": "/userName eq \"${username}\""
      },
      "credential-internaluser-query": {
        "_queryFilter": "/_id eq \"${username}\""
      },
      "links-for-firstId": {
        "_queryFilter": "/linkType eq \"${linkType}\" AND /firstId = \"${firstId}\""
      },
      "links-for-linkType": {
        "_queryFilter": "/linkType eq \"${linkType}\""
      },
      "query-all": {
        "_queryFilter": "true"
      }
    }
  },
  "commands" : {
    "delete-mapping-links" : {
      "_queryFilter": "/linkType eq \"${mapping}\"",
      "operation": "DELETE"
    }
  },
  "rest2LdapOptions": {
    "readOnUpdatePolicy": "controls",
    "useSubtreeDelete": false,
    "usePermissiveModify": true,
    "useMvcc": true,
    "mvccAttribute": "etag"
  },
  "resourceMapping": {
    "defaultMapping": {
      "resource": "default"
    },
    "explicitMapping": {
      "internal/user": {
        "resource": "internal/user",
        "propertiesToStringify": [ "password", "roles" ]
      },
      "internal/role": {
        "resource": "internal/role"
      },
      "link": {
        "resource": "link",
        "propertiesToStringify": [],
        "uniqueFields" : [
          ["linkType", "linkQualifier", "firstId"],
          ["linkType", "linkQualifier", "secondId"]
        ]
      }
    },
    "genericMapping": {
      "config": {
        "resource": "config"
      },
      "managed/user": {
        "resource": "managed/user"
      },
      "managed/*": {
        "resource": "managed/role"
      },
      "scheduler": {
        "resource": "scheduler"
      },
      "cluster": {
        "resource": "cluster"
      },
      "relationships": {
        "resource": "relationships"
      },
      "updates": {
        "resource": "updates"
      }
    }
  },
  "resources": {
    "repo": {
      "subResources": {
        "default": {
          "type": "collection",
          "dnTemplate": "ou=generic,dc=openidm,dc=forgerock,dc=com",
          "resource": "generic",
          "namingStrategy": {
            "dnAttribute": "uid",
            "type": "clientDnNaming"
          }
        },
        "managed/user": {
          "type": "collection",
          "dnTemplate": "ou=users,ou=managed,dc=openidm,dc=forgerock,dc=com",
          "resource": "generic",
          "namingStrategy": {
            "dnAttribute": "uid",
            "type": "clientDnNaming"
          }
        },
        "managed/role": {
          "type": "collection",
          "dnTemplate": "ou=roles,ou=managed,dc=openidm,dc=forgerock,dc=com",
          "resource": "generic",
          "namingStrategy": {
            "dnAttribute": "uid",
            "type": "clientDnNaming"
          }
        },
        "scheduler": {
          "type": "collection",
          "dnTemplate": "ou=scheduler,dc=openidm,dc=forgerock,dc=com",
          "resource": "generic",
          "namingStrategy": {
            "dnAttribute": "uid",
            "type": "clientDnNaming"
          }
        },
        "cluster": {
          "type": "collection",
          "dnTemplate": "ou=cluster,dc=openidm,dc=forgerock,dc=com",
          "resource": "generic",
          "namingStrategy": {
            "dnAttribute": "uid",
            "type": "clientDnNaming"
          }
        },
        "relationships": {
          "type": "collection",
          "dnTemplate": "ou=relationships,dc=openidm,dc=forgerock,dc=com",
          "resource": "generic",
          "namingStrategy": {
            "dnAttribute": "uid",
            "type": "clientDnNaming"
          }
        },
        "updates": {
          "type": "collection",
          "dnTemplate": "ou=updates,dc=openidm,dc=forgerock,dc=com",
          "resource": "generic",
          "namingStrategy": {
            "dnAttribute": "uid",
            "type": "clientDnNaming"
          }
        },
        "internal/user": {
          "type": "collection",
          "dnTemplate": "ou=users,ou=internal,dc=openidm,dc=forgerock,dc=com",
          "resource": "internal_user",
          "namingStrategy": {
            "dnAttribute": "uid",
            "type": "clientDnNaming"
          }
        },
        "internal/role": {
          "type": "collection",
          "dnTemplate": "ou=roles,ou=internal,dc=openidm,dc=forgerock,dc=com",
          "resource": "internal_role",
          "namingStrategy": {
            "dnAttribute": "cn",
            "type": "clientDnNaming"
          }
        },
        "link": {
          "type": "collection",
          "dnTemplate": "ou=links,dc=openidm,dc=forgerock,dc=com",
          "resource": "link",
          "namingStrategy": {
            "dnAttribute": "objectid",
            "type": "clientDNNaming"
          }
        },
        "config": {
          "type": "collection",
          "dnTemplate": "ou=config,dc=openidm,dc=forgerock,dc=com",
          "resource": "generic",
          "namingStrategy": {
            "dnAttribute": "uid",
            "type": "clientDnNaming"
          }
        }
      }
    },
    "link": {
        "objectClasses": [ "top", "openidmLink" ],
        "properties": {
          "_id": {
            "type": "simple", "ldapAttribute": "objectid", "isRequired": true, "writability": "createOnly"
          },
          "_rev": {
            "type": "simple", "ldapAttribute": "etag", "writability": "readOnly"
          },
          "linkType": {
            "type": "simple", "ldapAttribute": "linktype"
          },
          "linkQualifier": {
            "type": "simple", "ldapAttribute": "linkqualifier"
          },
          "firstId": {
            "type": "simple", "ldapAttribute": "firstid"
          },
          "secondId": {
            "type": "simple", "ldapAttribute": "secondid"
          }
        }
    },
    "internal_user": {
      "objectClasses": [ "top", "openidmInternalUser" ],
      "properties": {
        "_id": {
          "type": "simple", "ldapAttribute": "uid", "isRequired": true, "writability": "createOnly"
        },
        "_rev": {
          "type": "simple", "ldapAttribute": "etag", "writability": "readOnly"
        },
        "roles": {
          "type": "simple", "ldapAttribute": "roles"
        },
        "password": {
          "type": "simple", "ldapAttribute": "password"
        }
      }
    },
    "internal_role": {
      "objectClasses": [ "top", "openidmInternalRole" ],
      "properties": {
        "_id": {
          "type": "simple", "ldapAttribute": "cn", "isRequired": true, "writability": "createOnly"
        },
        "_rev": {
          "type": "simple", "ldapAttribute": "etag", "writability": "readOnly"
        },
        "description": {
          "type": "simple", "ldapAttribute": "description"
        }
      }
    },
    "generic": {
      "objectClasses": [ "top", "openidmGenericObject"],
      "properties": {
        "_id": {
          "type": "simple", "ldapAttribute": "uid", "isRequired": true, "writability": "createOnly"
        },
        "_rev": {
          "type": "simple", "ldapAttribute": "etag", "writability": "readOnly"
        },
        "fullobject": {
          "type": "json", "ldapAttribute": "fullobject"
        },
        "objecttype": {
          "type": "simple", "ldapAttribute": "objecttype", "isRequired": true, "writability": "createOnly"
        }
      }
    },
    "managed_user": {
      "objectClasses": [ "top", "person", "organizationalPerson", "inetOrgPerson", "openidmManagedUser" ],
      "properties": {
        "_id": {
          "type": "simple", "ldapAttribute": "uid", "isRequired": true, "writability": "createOnly"
        },
        "_rev": {
          "type": "simple", "ldapAttribute": "etag", "writability": "readOnly"
        },
        "userName": {
          "type": "simple", "ldapAttribute": "cn"
        },
        "password": {
          "type": "simple", "ldapAttribute": "password"
        },
        "accountStatus": {
          "type": "simple", "ldapAttribute": "accountStatus"
        },
        "roles": {
          "type": "simple", "ldapAttribute": "roles", "isMultiValued": true
        },
        "effectiveRoles": {
          "type": "simple", "ldapAttribute": "effectiveRoles", "isMultiValued": true
        },
        "effectiveAssignments": {
          "type": "simple", "ldapAttribute": "effectiveAssignments"
        },
        "lastPasswordSet": {
          "type": "simple", "ldapAttribute": "lastPasswordSet"
        },
        "postalCode": {
          "type": "simple", "ldapAttribute": "postalCode"
        },
        "stateProvince": {
          "type": "simple", "ldapAttribute": "st"
        },
        "passwordAttempts": {
          "type": "simple", "ldapAttribute": "passwordAttempts"
        },
        "lastPasswordAttempt": {
          "type": "simple", "ldapAttribute": "lastPasswordAttempt"
        },
        "postalAddress": {
          "type": "simple", "ldapAttribute": "postalAddress"
        },
        "displayName": {
          "type": "simple", "ldapAttribute": "displayName"
        },
        "description": {
          "type": "simple", "ldapAttribute": "description"
        },
        "country": {
          "type": "simple", "ldapAttribute": "country"
        },
        "address2": {
          "type": "simple", "ldapAttribute": "address2"
        },
        "city": {
          "type": "simple", "ldapAttribute": "l"
        },
        "givenName": {
          "type": "simple", "ldapAttribute": "givenName"
        },
        "sn": {
          "type": "simple", "ldapAttribute": "sn"
        },
        "telephoneNumber": {
          "type": "simple", "ldapAttribute": "telephoneNumber"
        },
        "mail": {
          "type": "simple", "ldapAttribute": "mail"
        },
        "siteImage": {
          "type": "simple", "ldapAttribute": "jpegPhoto"
        },
        "passPhrase": {
          "type": "simple", "ldapAttribute": "passPhrase"
        },
        "securityAnswer": {
          "type": "simple", "ldapAttribute": "securityAnswer"
        },
        "securityQuestion": {
          "type": "simple", "ldapAttribute": "securityQuestion"
        },
        "securityAnswerAttempts": {
          "type": "simple", "ldapAttribute": "securityAnswerAttempts"
        },
        "lastSecurityAnswerAttempt": {
          "type": "simple", "ldapAttribute": "lastSecurityAnswerAttempt"
        },
        "total": {
          "type": "simple", "ldapAttribute": "total"
        }
      }
    }
  }
}
